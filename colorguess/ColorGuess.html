<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Color Guesser</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/feather-icons"></script>
    <script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/animejs/lib/anime.iife.min.js"></script>
    <style>
      .color-swatch {
        transition: all 0.3s ease;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      }
      .color-swatch:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 15px rgba(0, 0, 0, 0.1);
      }
      .correct {
        animation: pulse 0.5s;
      }
      @keyframes pulse {
        0% {
          transform: scale(1);
        }
        50% {
          transform: scale(1.1);
        }
        100% {
          transform: scale(1);
        }
      }
      .incorrect {
        animation: shake 0.5s;
      }
      @keyframes shake {
        0%,
        100% {
          transform: translateX(0);
        }
        20%,
        60% {
          transform: translateX(-5px);
        }
        40%,
        80% {
          transform: translateX(5px);
        }
      }
    </style>
  </head>
  <body
    class="bg-gray-50 min-h-screen flex flex-col items-center justify-center p-4"
  >
    <div class="max-w-3xl w-full bg-white rounded-xl shadow-lg p-6 md:p-8">
      <header class="text-center mb-8">
        <h1 class="text-3xl md:text-4xl font-bold text-gray-800 mb-2">
          Guess the Color
        </h1>
        <p class="text-gray-600">Test your color perception skills!</p>
      </header>

      <div class="flex flex-col items-center mb-8">
        <p class="text-xl font-semibold text-gray-700 mb-4" id="colorName">
          Guess the color with code: Loading...
        </p>
      </div>

      <div
        class="grid grid-cols-2 md:grid-cols-3 gap-4 mb-8"
        id="colorOptions"
      ></div>

      <div class="flex justify-between items-center mb-6">
        <div class="text-lg font-medium">
          <span class="text-green-600"
            >Correct: <span id="correctCount">0</span></span
          >
          <span class="mx-2">|</span>
          <span class="text-gray-700"
            >Total: <span id="totalCount">0</span></span
          >
        </div>
        <button
          id="newGameBtn"
          class="flex items-center gap-2 bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition"
        >
          <i data-feather="refresh-cw" class="w-4 h-4"></i>
          New Game
        </button>
      </div>

      <div class="flex justify-center">
        <div class="flex gap-2">
          <button
            class="difficulty-btn px-3 py-1 rounded-md bg-gray-200 hover:bg-gray-300 transition"
            data-difficulty="easy"
          >
            Easy
          </button>
          <button
            class="difficulty-btn px-3 py-1 rounded-md bg-gray-200 hover:bg-gray-300 transition"
            data-difficulty="medium"
          >
            Medium
          </button>
          <button
            class="difficulty-btn px-3 py-1 rounded-md bg-gray-200 hover:bg-gray-300 transition font-semibold bg-blue-100 text-blue-700"
            data-difficulty="hard"
          >
            Hard
          </button>
        </div>
      </div>
    </div>

    <div
      id="feedback"
      class="fixed top-4 left-1/2 transform -translate-x-1/2 px-4 py-2 rounded-md shadow-lg hidden"
    ></div>

    <script>
      // Game state
      let gameState = {
        correctAnswers: 0,
        totalQuestions: 0,
        difficulty: "hard",
        currentColor: null,
        colorOptions: [],
      };

      // DOM elements
      const colorNameEl = document.getElementById("colorName");
      const colorOptionsEl = document.getElementById("colorOptions");
      const correctCountEl = document.getElementById("correctCount");
      const totalCountEl = document.getElementById("totalCount");
      const newGameBtn = document.getElementById("newGameBtn");
      const difficultyBtns = document.querySelectorAll(".difficulty-btn");
      const feedbackEl = document.getElementById("feedback");

      // Initialize game
      document.addEventListener("DOMContentLoaded", () => {
        feather.replace();
        loadScores();
        startNewRound();

        // Set up event listeners
        newGameBtn.addEventListener("click", startNewRound);
        difficultyBtns.forEach((btn) => {
          btn.addEventListener("click", () => {
            gameState.difficulty = btn.dataset.difficulty;
            difficultyBtns.forEach((b) =>
              b.classList.remove(
                "font-semibold",
                "bg-blue-100",
                "text-blue-700"
              )
            );
            btn.classList.add("font-semibold", "bg-blue-100", "text-blue-700");
            startNewRound();
          });
        });
      });

      // Generate random color
      function getRandomColor() {
        const letters = "0123456789ABCDEF";
        let color = "#";
        for (let i = 0; i < 6; i++) {
          color += letters[Math.floor(Math.random() * 16)];
        }
        return color;
      }

      // Generate similar colors based on difficulty
      function generateSimilarColors(baseColor, count) {
        const colors = [baseColor];
        const baseR = parseInt(baseColor.slice(1, 3), 16);
        const baseG = parseInt(baseColor.slice(3, 5), 16);
        const baseB = parseInt(baseColor.slice(5, 7), 16);

        let variation;
        switch (gameState.difficulty) {
          case "easy":
            variation = 100;
            break;
          case "medium":
            variation = 50;
            break;
          default:
            variation = 20; // hard
        }

        while (colors.length < count) {
          const r = Math.max(
            0,
            Math.min(
              255,
              baseR + Math.floor(Math.random() * variation * 2 - variation)
            )
          );
          const g = Math.max(
            0,
            Math.min(
              255,
              baseG + Math.floor(Math.random() * variation * 2 - variation)
            )
          );
          const b = Math.max(
            0,
            Math.min(
              255,
              baseB + Math.floor(Math.random() * variation * 2 - variation)
            )
          );
          const color = `#${r.toString(16).padStart(2, "0")}${g
            .toString(16)
            .padStart(2, "0")}${b.toString(16).padStart(2, "0")}`;

          if (!colors.includes(color)) {
            colors.push(color);
          }
        }

        return colors;
      }

      // Shuffle array
      function shuffleArray(array) {
        for (let i = array.length - 1; i > 0; i--) {
          const j = Math.floor(Math.random() * (i + 1));
          [array[i], array[j]] = [array[j], array[i]];
        }
        return array;
      }

      // Start new round
      function startNewRound() {
        gameState.currentColor = getRandomColor();
        gameState.colorOptions = generateSimilarColors(
          gameState.currentColor,
          6
        );
        gameState.colorOptions = shuffleArray(gameState.colorOptions);

        renderGame();
      }

      // Render game UI
      function renderGame() {
        // Show the color code to guess
        colorNameEl.textContent = `Guess the color with code: ${gameState.currentColor}`;

        // Clear previous options
        colorOptionsEl.innerHTML = "";

        // Create new color options
        gameState.colorOptions.forEach((color) => {
          const colorEl = document.createElement("div");
          colorEl.className =
            "color-swatch cursor-pointer w-full h-24 rounded-lg flex items-center justify-center";
          colorEl.style.backgroundColor = color;
          colorEl.setAttribute("aria-label", `Color option: ${color}`);
          colorEl.setAttribute("role", "button");
          colorEl.setAttribute("tabindex", "0");

          colorEl.addEventListener("click", () => handleColorSelection(color));
          colorEl.addEventListener("keypress", (e) => {
            if (e.key === "Enter") handleColorSelection(color);
          });

          colorOptionsEl.appendChild(colorEl);
        });

        // Update score display
        correctCountEl.textContent = gameState.correctAnswers;
        totalCountEl.textContent = gameState.totalQuestions;
      }

      // Handle color selection
      function handleColorSelection(selectedColor) {
        gameState.totalQuestions++;

        if (selectedColor === gameState.currentColor) {
          // Correct answer
          gameState.correctAnswers++;
          showFeedback(
            `Correct! It was ${gameState.currentColor}`,
            "bg-green-100",
            "text-green-800"
          );

          // Highlight correct answer
          const options = Array.from(colorOptionsEl.children);
          const correctOption = options.find(
            (el) => el.style.backgroundColor === gameState.currentColor
          );
          if (correctOption) {
            correctOption.classList.add("correct");
          }

          // Start new round after delay
          setTimeout(startNewRound, 1000);
        } else {
          // Incorrect answer
          showFeedback(
            `Try again! It was ${gameState.currentColor}`,
            "bg-red-100",
            "text-red-800"
          );

          // Highlight incorrect answer
          const options = Array.from(colorOptionsEl.children);
          const selectedOption = options.find(
            (el) => el.style.backgroundColor === selectedColor
          );
          if (selectedOption) {
            selectedOption.classList.add("incorrect");
          }
        }

        // Update score display
        correctCountEl.textContent = gameState.correctAnswers;
        totalCountEl.textContent = gameState.totalQuestions;

        // Save scores
        saveScores();
      }

      // Show feedback message
      function showFeedback(message, bgClass, textClass) {
        feedbackEl.textContent = message;
        feedbackEl.className = `fixed top-4 left-1/2 transform -translate-x-1/2 px-4 py-2 rounded-md shadow-lg ${bgClass} ${textClass}`;
        feedbackEl.classList.remove("hidden");

        setTimeout(() => {
          feedbackEl.classList.add("hidden");
        }, 1500);
      }

      // Save scores to localStorage
      function saveScores() {
        localStorage.setItem(
          "colorGuesserScores",
          JSON.stringify({
            correctAnswers: gameState.correctAnswers,
            totalQuestions: gameState.totalQuestions,
          })
        );
      }

      // Load scores from localStorage
      function loadScores() {
        const savedScores = localStorage.getItem("colorGuesserScores");
        if (savedScores) {
          const scores = JSON.parse(savedScores);
          gameState.correctAnswers = scores.correctAnswers || 0;
          gameState.totalQuestions = scores.totalQuestions || 0;
        }
      }
    </script>
    <script>
      feather.replace();
    </script>
  </body>
</html>
