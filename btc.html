<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Calorie Calculator | BMR & TDEE</title>

    <!-- Bootstrap 5 CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC"
      crossorigin="anonymous"
    />

    <!-- Chart.js CDN -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <style>
      body {
        font-family: "Poppins", sans-serif;
        background-color: #f8f9fa;
        color: #222;
        transition: background-color 0.2s, color 0.2s;
      }

      .card {
        border-radius: 1rem;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
        transition: 0.25s ease;
      }

      .card:hover {
        box-shadow: 0 8px 30px rgba(0, 0, 0, 0.12);
      }

      .form-label {
        font-weight: 600;
      }

      .gender-group {
        display: flex;
        gap: 15px;
      }

      .activity-group {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
        gap: 8px;
      }

      .result-box {
        margin-top: 20px;
        padding: 15px;
        border-radius: 10px;
        background: rgba(0, 0, 0, 0.03);
      }

      canvas {
        margin-top: 18px;
      }

      @media (max-width: 576px) {
        .gender-group {
          flex-direction: column;
        }
      }
    </style>
  </head>

  <body>
    <div class="container py-4">
      <div class="card p-4 mx-auto" style="max-width: 900px">
        <h2 class="text-center mb-4">Calorie Calculator</h2>

        <form id="calorieForm" class="mb-3">
          <div class="row g-3 mb-3">
            <div class="col-md-4">
              <label class="form-label" for="age">Age</label>
              <input type="number" id="age" class="form-control" required />
            </div>

            <div class="col-md-4">
              <label class="form-label" for="height">Height (cm)</label>
              <input type="number" id="height" class="form-control" required />
            </div>

            <div class="col-md-4">
              <label class="form-label" for="weight">Weight (kg)</label>
              <input type="number" id="weight" class="form-control" required />
            </div>
          </div>

          <!-- Gender -->
          <div class="mb-3">
            <label class="form-label">Gender</label>
            <div class="gender-group">
              <div class="form-check">
                <input
                  class="form-check-input"
                  type="radio"
                  name="gender"
                  id="male"
                  value="male"
                  required
                />
                <label class="form-check-label" for="male">Male</label>
              </div>

              <div class="form-check">
                <input
                  class="form-check-input"
                  type="radio"
                  name="gender"
                  id="female"
                  value="female"
                />
                <label class="form-check-label" for="female">Female</label>
              </div>
            </div>
          </div>

          <!-- Activity Level -->
          <div class="mb-3">
            <label class="form-label">Activity Level</label>
            <div class="activity-group">
              <div class="form-check">
                <input
                  class="form-check-input"
                  type="radio"
                  name="activity"
                  id="sedentary"
                  value="1.2"
                  required
                />
                <label class="form-check-label" for="sedentary"
                  >Sedentary (little/no exercise)</label
                >
              </div>

              <div class="form-check">
                <input
                  class="form-check-input"
                  type="radio"
                  name="activity"
                  id="light"
                  value="1.375"
                />
                <label class="form-check-label" for="light"
                  >Lightly active (1-3 days/week)</label
                >
              </div>

              <div class="form-check">
                <input
                  class="form-check-input"
                  type="radio"
                  name="activity"
                  id="moderate"
                  value="1.55"
                />
                <label class="form-check-label" for="moderate"
                  >Moderately active (3-5 days/week)</label
                >
              </div>

              <div class="form-check">
                <input
                  class="form-check-input"
                  type="radio"
                  name="activity"
                  id="very"
                  value="1.725"
                />
                <label class="form-check-label" for="very"
                  >Very active (6-7 days/week)</label
                >
              </div>

              <div class="form-check">
                <input
                  class="form-check-input"
                  type="radio"
                  name="activity"
                  id="super"
                  value="1.9"
                />
                <label class="form-check-label" for="super"
                  >Super active (twice/day training/manual labor)</label
                >
              </div>
            </div>
          </div>

          <!-- Goal -->
          <div class="mb-3">
            <label class="form-label">Goal</label>
            <div class="activity-group">
              <div class="form-check">
                <input
                  class="form-check-input"
                  type="radio"
                  name="goal"
                  id="maintain"
                  value="maintain"
                  required
                />
                <label class="form-check-label" for="maintain">Maintain</label>
              </div>

              <div class="form-check">
                <input
                  class="form-check-input"
                  type="radio"
                  name="goal"
                  id="lose"
                  value="lose"
                />
                <label class="form-check-label" for="lose">Lose Weight</label>
              </div>

              <div class="form-check">
                <input
                  class="form-check-input"
                  type="radio"
                  name="goal"
                  id="gain"
                  value="gain"
                />
                <label class="form-check-label" for="gain">Gain Weight</label>
              </div>
            </div>
          </div>

          <div class="text-center">
            <button type="submit" class="btn btn-primary px-4">
              Calculate
            </button>
            <button
              type="button"
              id="resetBtn"
              class="btn btn-outline-secondary ms-2"
            >
              Reset
            </button>
          </div>
        </form>

        <!-- Results -->
        <div id="result" class="result-box text-center fw-bold"></div>

        <!-- Chart (responsive) -->
        <div class="mt-3">
          <canvas id="calorieChart" height="120"></canvas>
        </div>
      </div>
    </div>

    <!-- Bootstrap JS Bundle -->
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
      crossorigin="anonymous"
    ></script>

    <script>
      // Keep chart instance accessible
      let chartInstance = null;

      // Helper: safe number parse
      function toNum(v) {
        const n = parseFloat(v);
        return Number.isFinite(n) ? n : NaN;
      }

      document
        .getElementById("calorieForm")
        .addEventListener("submit", function (e) {
          e.preventDefault();

          const age = toNum(document.getElementById("age").value);
          const height = toNum(document.getElementById("height").value);
          const weight = toNum(document.getElementById("weight").value);
          const genderEl = document.querySelector(
            'input[name="gender"]:checked'
          );
          const activityEl = document.querySelector(
            'input[name="activity"]:checked'
          );
          const goalEl = document.querySelector('input[name="goal"]:checked');
          const resultDiv = document.getElementById("result");

          if (
            !age ||
            !height ||
            !weight ||
            !genderEl ||
            !activityEl ||
            !goalEl
          ) {
            resultDiv.innerHTML =
              "<p class='text-danger'>⚠️ Please fill all fields and select options.</p>";
            return;
          }

          const gender = genderEl.value;
          const activity = toNum(activityEl.value);
          const goal = goalEl.value;

          // Calculate BMR (Mifflin-St Jeor)
          let bmr =
            gender === "male"
              ? 10 * weight + 6.25 * height - 5 * age + 5
              : 10 * weight + 6.25 * height - 5 * age - 161;

          // TDEE
          let tdee = bmr * activity;

          // Goal calories (safe deficit/surplus)
          let calorieGoal;
          if (goal === "maintain") calorieGoal = tdee;
          else if (goal === "lose")
            calorieGoal = Math.max(1200, tdee - 400); // avoid extreme low
          else calorieGoal = tdee + 400;

          resultDiv.innerHTML = `
          <p class="mb-1">Your <strong>BMR</strong>: ${bmr.toFixed(
            0
          )} kcal/day</p>
          <p class="mb-1">Your <strong>TDEE</strong>: ${tdee.toFixed(
            0
          )} kcal/day</p>
          <p class="mb-0">To <strong>${goal}</strong> weight, target around <strong>${calorieGoal.toFixed(
            0
          )}</strong> kcal/day.</p>
        `;

          // Draw chart
          const ctx = document.getElementById("calorieChart").getContext("2d");
          if (chartInstance) chartInstance.destroy();

          chartInstance = new Chart(ctx, {
            type: "bar",
            data: {
              labels: ["BMR", "TDEE", "Goal"],
              datasets: [
                {
                  label: "Calories (kcal/day)",
                  data: [
                    bmr.toFixed(0),
                    tdee.toFixed(0),
                    calorieGoal.toFixed(0),
                  ],
                  backgroundColor: ["#0d6efd", "#198754", "#fd7e14"],
                  borderRadius: 6,
                },
              ],
            },
            options: {
              responsive: true,
              maintainAspectRatio: false,
              plugins: {
                legend: { display: false },
                tooltip: {
                  callbacks: {
                    label: function (ctx) {
                      return ctx.formattedValue + " kcal/day";
                    },
                  },
                },
                title: {
                  display: true,
                  text: "Caloric Profile",
                  padding: { top: 6, bottom: 6 },
                  font: { weight: "600" },
                },
              },
              scales: {
                y: {
                  beginAtZero: true,
                  ticks: {
                    callback: function (v) {
                      return v + " kcal";
                    },
                  },
                },
              },
            },
          });
        });

      // Reset button
      document
        .getElementById("resetBtn")
        .addEventListener("click", function () {
          document.getElementById("calorieForm").reset();
          document.getElementById("result").innerHTML = "";
          if (chartInstance) {
            chartInstance.destroy();
            chartInstance = null;
          }
        });
    </script>
  </body>
</html>
