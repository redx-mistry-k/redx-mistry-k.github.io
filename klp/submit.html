<!DOCTYPE html>
<html>
<head>
  <title>Submit Knowledge</title>
  <meta charset="utf-8">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body onload="requireAuth()">

<script src="klp.js"></script>
<script>requireAuth();</script>

<!-- NAVBAR -->
<nav class="navbar navbar-dark bg-dark mb-4">
  <div class="container-fluid">
    <a class="navbar-brand" href="index.html">KLP</a>
    <div>
      <a class="btn btn-sm btn-outline-light me-2" href="submit.html">Submit</a>
      <a class="btn btn-sm btn-outline-light me-2" href="my-items.html">My Knowledge</a>
      <a class="btn btn-sm btn-outline-light me-2" href="approval.html">Approvals</a>
      <button class="btn btn-sm btn-danger" onclick="logout()">Logout</button>
    </div>
  </div>
</nav>

<div class="container">
  <h3 class="mb-4">Submit Knowledge</h3>

  <form onsubmit="submitForm(event)" class="card p-4 shadow-sm">
    <input class="form-control mb-3" placeholder="Title" required>
    <input class="form-control mb-3" placeholder="System / Tool">

    <select class="form-select mb-3">
      <option>IT</option>
      <option>Finance</option>
      <option>HR</option>
    </select>

    <textarea class="form-control mb-3" placeholder="Description"></textarea>

    <button class="btn btn-primary">Save Draft</button>
  </form>
</div>

<script>
async function submitForm(e) {
  e.preventDefault();

  const inputs = e.target.querySelectorAll("input, select, textarea");

  const payload = {
    title: inputs[0].value,
    system: inputs[1].value,
    process_area: inputs[2].value,
    description: inputs[3].value
  };

  await api("/knowledge", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify(payload)
  });

  alert("Draft saved");
  window.location.href = "my-items.html";
}
</script>

</body>
</html>

