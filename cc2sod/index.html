<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Cancelled Orders → Orders Converter</title>

<style>
  * { box-sizing: border-box; }

  body {
    font-family: system-ui, -apple-system, "Segoe UI", Roboto, Arial, sans-serif;
    background: linear-gradient(135deg, #eef2f7, #f9fbfd);
    padding: 24px;
    color: #1f2937;
  }

  .wrapper {
    max-width: 1300px;
    margin: auto;
  }

  .card {
    background: #fff;
    border-radius: 10px;
    padding: 24px;
    box-shadow: 0 8px 24px rgba(0,0,0,0.08);
    margin-bottom: 24px;
  }

  h1 { font-size: 22px; margin-bottom: 6px; }
  h2 { font-size: 18px; margin-bottom: 6px; }

  p {
    margin: 0 0 14px;
    color: #6b7280;
    font-size: 14px;
  }

  textarea {
    width: 100%;
    height: 220px;
    resize: vertical;
    font-family: Consolas, monospace;
    font-size: 13px;
    padding: 12px;
    border-radius: 6px;
    border: 1px solid #d1d5db;
    background: #f9fafb;
  }

  textarea:focus {
    outline: none;
    border-color: #2563eb;
    background: #fff;
  }

  .actions {
    display: flex;
    gap: 12px;
    justify-content: center;
    margin: 20px 0;
    flex-wrap: wrap;
  }

  button {
    background: #2563eb;
    color: #fff;
    border: none;
    padding: 12px 26px;
    font-size: 14px;
    border-radius: 6px;
    cursor: pointer;
  }

  button.secondary {
    background: #10b981;
  }

  button:hover { opacity: 0.9; }

  .meta {
    font-size: 13px;
    color: #4b5563;
    margin-bottom: 10px;
  }

  .preview-wrapper {
    max-height: 260px;
    overflow: auto;
    border: 1px solid #e5e7eb;
    border-radius: 6px;
  }

  table {
    width: 100%;
    border-collapse: collapse;
    font-size: 12px;
  }

  thead {
    background: #f3f4f6;
    position: sticky;
    top: 0;
  }

  th, td {
    padding: 6px 8px;
    border-bottom: 1px solid #e5e7eb;
    white-space: nowrap;
  }

  th {
    font-weight: 600;
    text-align: left;
  }

  footer {
    text-align: center;
    font-size: 12px;
    color: #9ca3af;
  }
</style>
</head>

<body>
<div class="wrapper">

  <div class="card">
    <h1>Cancelled Orders → Orders Converter</h1>
    <p>Convert cancelled orders data into orders format instantly.</p>
  </div>

  <div class="card">
    <h2>Paste Cancelled Orders Data</h2>
    <p>Paste data copied from Excel. Header row must be included.</p>
    <textarea id="inputData" placeholder="Paste Cancelled Orders data here..."></textarea>
  </div>

  <div class="actions">
    <button onclick="convertData()">Convert</button>
    <button class="secondary" onclick="copyOutput()">Copy Output</button>
  </div>

  <div class="card">
    <h2>Orders Output</h2>
    <p>Tab-separated data. Ready to paste into Excel.</p>

    <div class="meta" id="rowCount">Rows: 0</div>

    <textarea id="outputData" placeholder="Converted Orders data will appear here..."></textarea>
  </div>

  <div class="card">
    <h2>Preview (first 10 rows)</h2>
    <p>Quick check before pasting into Excel.</p>

    <div class="preview-wrapper">
      <table id="previewTable">
        <thead></thead>
        <tbody></tbody>
      </table>
    </div>
  </div>

  <footer>
    Internal helper tool • No data is stored
  </footer>

</div>

<script>
const orderColumns = [
  "InternalID","StudyOrderNumberTextField","Study_Name","GLP_NON-GLP",
  "Work_Order_Number","Compound_Name","ItemMasterID","SampleUOM",
  "Receipt_Date","Place_of_Storage","Study_Type","Department",
  "Study_Order_Number","Study_Director","Study_Allocated_Date",
  "Study_Completion_Date","Last_Updated","Updated_By","ID",
  "Study_Status","Sponsor_Name","ToMailID","CCMailID","Modified",
  "Created","Created By","Modified By","MirrorID","StudyInitiationDate",
  "ExperimentStartDate","ExperimentEndDate","EnquiryNumber","SponsorID",
  "StudyMasterID","EnquiryMasterID","Guideline","GuidelineRemarks",
  "Qty","Rate","Value","Currency","DiscountPercentage","DiscountAmount",
  "GSTPercentage","TaxAmount","TaxableAmount","OtherCharges","ValidityDate",
  "SampleRemarks","QtyToBeReceived","QuotationRemarks",
  "QuotationPreparedDate","SupportingAttachments","StandardDetails",
  "ReferenceNumber","SupportingDocumentPath","StudyOrderValue",
  "ForeignCurrencyConversionRate","StudyOrderValueinINR","InvoicedAmount",
  "WriteOffAmount","BalanceAmount","AgentName","RoundedValue",
  "ItemIssuedQty","Samples_Remarks","CancellationInProgress",
  "CancellationLogID","Revenue","ReturnToAdvance","Refund",
  "CancelledOrderValue","InvoiceRequestedAmount","OriginalOrderValue",
  "DifferenceOrderValue"
];

const blankColumns = ["ID", "MirrorID"];

function convertData() {
  const input = document.getElementById("inputData").value.trim();
  if (!input) return;

  const rows = input.split("\n").map(r => r.split("\t"));
  const headers = rows[0];
  const dataRows = rows.slice(1);

  const headerIndex = {};
  headers.forEach((h, i) => headerIndex[h.trim()] = i);

  const outputRows = dataRows.map(row =>
    orderColumns.map(col => {
      if (blankColumns.includes(col)) return "";
      const idx = headerIndex[col];
      return idx !== undefined ? (row[idx] || "") : "";
    })
  );

  document.getElementById("outputData").value =
    outputRows.map(r => r.join("\t")).join("\n");

  document.getElementById("rowCount").textContent =
    `Rows: ${outputRows.length}`;

  renderPreview(outputRows);
}

function copyOutput() {
  const output = document.getElementById("outputData");
  if (!output.value) return;
  output.select();
  document.execCommand("copy");
}

function renderPreview(rows) {
  const thead = document.querySelector("#previewTable thead");
  const tbody = document.querySelector("#previewTable tbody");

  thead.innerHTML = "";
  tbody.innerHTML = "";

  const headRow = document.createElement("tr");
  orderColumns.forEach(col => {
    const th = document.createElement("th");
    th.textContent = col;
    headRow.appendChild(th);
  });
  thead.appendChild(headRow);

  rows.slice(0, 10).forEach(r => {
    const tr = document.createElement("tr");
    r.forEach(val => {
      const td = document.createElement("td");
      td.textContent = val;
      tr.appendChild(td);
    });
    tbody.appendChild(tr);
  });
}
</script>

</body>
</html>
